---
layout: layout
title: Tools and Memo
mathjax: true
custom_js: js/tools.js
---

<h1>公開備忘録</h1>

<p>
注意：
このページは著者の私的なメモを外出時等に手軽に参照できるように設けたチートシートです。
このページから得た情報によって生じたいかなる不利益に関しても著者は責任を負わないものとします。
</p>

<div class="topic"><h2>文字数・単語数カウント + 改行削除</h2><div class="toggle-content hidden">
<h3>今すぐこの場で（簡易版）</h3>
<ul>
  <li>複数行にまたがる単語の行末のハイフネーションは除去しません。</li>
  <li>文字コードの統計に基づいて簡易的な言語判定を行い、非欧文と判定された場合はスペースを削除します。</li>
</ul>
<textarea id="moji_count" cols="100" rows="10"></textarea>
<div>
  <span class="result-display" id="wcharCount">0文字</span>
  <span class="result-display" id="wordCount">0単語</span>
</div>

<h3>wc</h3>
<pre>
wc --chars # 文字数
wc --words # 単語数
</pre>

</div></div>

<div class="topic"><h2>西暦・和暦</h2><div class="toggle-content hidden">
西暦 <input id="seireki" type="number" style="width: 5em"> 年
<span class="result-display" id="wareki"> ?? 年</span>

</div></div>

<div class="topic"><h2>arXivのURL変換</h2><div class="toggle-content hidden">
  <p>※ URLを入力したら一度他のところをクリックしてください。</p>
  <p>※ Abstract の URL はクリップボードにコピーされます。</p>
  arXiv の PDF か abstract の URL を入力<br>
  <input id="arxivurl" type="text" style="width: 100%; max-width: 40em"><br>
  <span id="arxivabs">Abstract</span><br>
  <span id="arxivpdf">PDF</span>

</div></div>

<div class="topic"><h2>振幅とデシベル</h2><div class="toggle-content hidden">
\(y = 10 \log_{10} x^2\) <br>

\(y \text{ [dB]} = \)<input id="db2amp" type="number" step="any" style="width: 5em">
\(\to x = \)<span class="result-display" id="amp_result"></span><br>

\(x = \)<input id="amp2db" type="number" step="any" style="width: 5em">
\(\to y \text{ [dB]} = \)<span class="result-display" id="db_result"></span>

</div></div>

<div class="topic"><h2>MIDI to 周波数</h2><div class="toggle-content hidden">
MIDI note number: <input id="midi2freq" type="number" style="width: 5em">
<span class="result-display" id="notefreq">音名・周波数</span>

</div></div>

<div class="topic"><h2>$/h → ￥/mon</h2><div class="toggle-content hidden">
<input id="cost_usd" type="number" step="any" style="width: 5em"> ドル/時間
× 為替レート <input id="exchange_rate" type="number" value="150" style="width: 5em"> 円/ドル →
<span class="result-display" id="hourly_cost_2_monthly">料金</span>
<br>
<small>注：1セント/時 ≒ 1000円/月 (為替150円換算)</small>

</div></div>

<div class="topic"><h2>BPS and Beats to Time</h2><div class="toggle-content hidden">
BPS (beats per second): <input id="bps" type="number" step="any" style="width: 5em">
Beats: <input id="n_beats" type="number" style="width: 5em">
<span class="result-display" id="bps_nbeats_2_time">時間</span>

</div></div>

<div class="topic"><h2>BMI</h2><div class="toggle-content hidden">
身長: <input id="bmi_height" type="number" step="any" style="width: 5em"> cm
体重: <input id="bmi_weight" type="number" step="any" style="width: 5em"> kg
<span class="result-display" id="bmi">BMI</span>

</div></div>

<div class="topic"><h2>世界時計</h2><div class="toggle-content hidden">
日本時間：<input id="jst_to_worldtime" type="number" style="width: 5em"> 時<br>
<span id="timelist">世界の時刻</span>

</div></div>

<div class="topic"><h2>カウントダウンタイマー</h2><div class="toggle-content hidden">
  <span>（うるう年などは正確には考慮していない目安の日数）</span>
  <span id="TimeLeft"></span>
</div></div>

<div class="topic"><h2>ひらがな・カタカナ変換</h2><div class="toggle-content hidden">
入力：<textarea id="kana_input" cols="50" rows="2"></textarea><br>
<b>→ カタカナ：</b><span class="result-display" id="kana_to_katakana"></span><br>
<b>→ ひらがな：</b><span class="result-display" id="kana_to_hiragana"></span>
</div></div>


<div class="topic"><h2>sox</h2><div class="toggle-content hidden">
<h3>一括してリサンプリング</h3>
<pre>
for file in `ls *.wav`
do
  sox $file -r 8000 -c 1 --norm ${file%.wav}_8k.wav trim 0 10
done
</pre>
r: rate, c: channel, norm正規化
<h3>右のチャンネルの抽出</h3>
<pre>
sox input.wav -c 1 -r 16000 output.wav mixer -r channels 1
</pre>
<h3>ファイルの長さを調べる</h3>
-n statで出てくる情報から適当に抽出
<pre>
len=`sox input.wav -n stat 2>&amp;1 | sed -n 's/^Length (seconds):[^0-9]*\([0-9.]*\)$/\1/p`
</pre>

</div></div>


<div class="topic"><h2>Pythonワンライナー</h2><div class="toggle-content hidden">
<h3>npzファイルの中身を簡易的にチェックする方法</h3>
<pre>
python3 -c "import sys;import numpy;D=numpy.load(sys.argv[1]);print([(k,D[k].shape) for k in D.keys()])" data.npz
</pre>
.bashrcなどにエイリアスを設定する場合の一例
<pre>
alias npz-check='python3 -c "import sys;import numpy;D=numpy.load(sys.argv[1]);print([(k,D[k].shape) for k in D.keys()])"'
npz-check data.npz
</pre>

<h3>オーディオファイルに含まれる音の最大周波数のおおよその値を求める方法</h3>
-50dBを上回る周波数のうち最大のものを探す。
<pre>
alias highest-freq='python3 -c "import sys as s,librosa as l,numpy as n;y,sr=l.load(s.argv[1],sr=None);N=8192;S=abs(l.stft(y,N)**2/N);S=n.log10(n.mean(S,axis=1))*10;a=next(i for i,x in enumerate(S[::-1]) if x>-50);F=(len(S)-a)/len(S)*sr;print(int(F),\"Hz\")"'
highest-freq data.wav
</pre>

<h3>スペクトログラムを表示（簡易版）</h3>
<pre>
alias show-spec='python3 -c "import matplotlib.pyplot as plt;import sys as s,librosa as l,numpy as n;y,sr=l.load(s.argv[1],sr=None);H=sr//100;N=H*4;S=abs(l.stft(y,N,H)**2/N);S=n.log10(S)*10;plt.imshow(n.flipud(S),aspect=\"auto\");plt.show(block=True)"'
show-spec data.wav
</pre>

</div></div>

<div class="topic"><h2>学習ログの整理</h2><div class="toggle-content hidden">
<h3>最新の10件のファイル以外を削除</h3>
<pre>
ls -t *.dat | tail -n +11 | xargs echo
# ls -t *.dat | tail -n +11 | xargs rm
# ls -t *.dat | tail -n +11 | xargs sudo rm -rf
</pre>

<h3>ファイルサイズのチェック</h3>
<pre>
du -h . -d 1
df -h .
</pre>

</div></div>

<p id="lastUpdate"></p>
